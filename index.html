<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liste des Membres</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-5">
        <h2 class="text-center">Liste des Membres du Smile Club Mahajanga</h2>
        <table class="table table-striped mt-4">
            <thead>
                <tr>
                    <th>Prénom</th>
                    <th>Nom</th>
                    <th>Contact</th>
                    <th>Adresse</th>
                    <th>Parcours Académique</th>
                    <th>Étudiant en Médecine</th>
                    <th>Photo</th>
                    <th>CV</th>
                </tr>
            </thead>
            <tbody id="membersTableBody">
                <!-- Les données seront insérées ici -->
            </tbody>
        </table>
    </div>
    
    <script>
        const sheetUrl = "https://docs.google.com/spreadsheets/d/199tgdDfSabO0Z_FzMix8rVGzzoAPfZJRDoBxZLZKMaY/gviz/tq?tqx=out:json";
        
        async function fetchMembers() {
            try {
                const response = await fetch(sheetUrl);
                let text = await response.text();
                text = text.substring(47, text.length - 2); // Nettoyage du JSON
                const data = JSON.parse(text);
                const rows = data.table.rows;
                let tableContent = "";
                
                rows.forEach(row => {
                    const [prenom, nom, contact, adresse, parcours, etudiantMedecine, photo, cv] = row.c.map(cell => cell?.v || "");
                    tableContent += `<tr>
                        <td>${prenom}</td>
                        <td>${nom}</td>
                        <td>${contact}</td>
                        <td>${adresse}</td>
                        <td>${parcours}</td>
                        <td>${etudiantMedecine}</td>
                        <td><img src="${photo}" alt="Photo" width="50" height="50"></td>
                        <td><a href="${cv}" target="_blank">Télécharger</a></td>
                    </tr>`;
                });
                document.getElementById("membersTableBody").innerHTML = tableContent;
            } catch (error) {
                console.error("Erreur lors de la récupération des données :", error);
            }
        }
        
        fetchMembers();
    </script>
</body>
</html>
